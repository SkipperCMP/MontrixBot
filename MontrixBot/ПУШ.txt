# === ШАГ 1. Прочитать версию из файла VERSION ===
$versionFile = "VERSION"
if (-Not (Test-Path $versionFile)) {
    Write-Host "Файл VERSION не найден!" -ForegroundColor Red
    exit
}

$version = Get-Content $versionFile -Raw
$version = $version.Trim()

Write-Host "Версия из файла VERSION: $version" -ForegroundColor Cyan

# === ШАГ 2. Добавить все изменения ===
git add .

# === ШАГ 3. Создать коммит ===
git commit -m "$version"

# === ШАГ 4. Отправить на GitHub ===
git push

# === ШАГ 5. Создать тег (если тега ещё нет) и отправить его ===
$tags = git tag
if ($tags -notcontains $version) {
    git tag -a $version -m "$version"
    git push origin $version
    Write-Host "Создан и отправлен новый тег: $version" -ForegroundColor Green
} else {
    Write-Host "Тег $version уже существует — пропускаю." -ForegroundColor Yellow
}

Write-Host "Готово! Все изменения отправлены." -ForegroundColor Green