{
  "project": "MontrixBot",
  "baseline": {
    "name": "MontrixBot_STEP1.3.3_RuntimeConsistency_pre3_BASELINE",
    "previous": "MontrixBot_STEP1.3.3_RuntimePersistence_pre2_BASELINE",
    "next": "MontrixBot_STEP1.3.3_RuntimeConsistency_pre4_BASELINE",
    "step": "1.3.3",
    "tag": "RuntimeConsistency",
    "pre": 3
  },
  "roadmap": {
    "working": "1.3.3 — Runtime Persistence / Snapshot → Runtime bridge",
    "extended_ref": "MontrixBot Roadmap v2.0 Extended Edition"
  },
  "files": {
    "changed": [
      "core/runtime_state.py"
    ]
  },
  "notes": [
    "persist_from_ui_snapshot() оформлен как официальный слой Runtime Persistence для STEP1.3.3",
    "Добавлена более строгая валидация формата UI-снапшота перед обновлением runtime-state",
    "Ветка \"positions\" в runtime_state синхронизируется с snapshot[\"positions\"] при условии, что это dict",
    "Ветка \"meta\" аккуратно объединяет существующие данные с meta/flags (mode, dry_run, portfolio, advisor) из снапшота",
    "SIM-ветка runtime_state по-прежнему не изменяется в runtime_persistence и остаётся зоной sim-движка",
    "Мелкий клинап: синхронизирован заголовок runtime_persistence и убраны неиспользуемые импорт/хелпер.",
    "Усилена нормализация runtime_state: _ensure_base_structure теперь гарантирует dict-тип для positions/meta/sim с мягким reset при кривых данных.",
    "Обновлён заголовок runtime_state под STEP1.3.3 Runtime-Consistency (pre3)."
  ]
}
